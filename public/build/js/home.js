document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("search-input"),n=document.getElementById("results-list");function t(e){n.innerHTML="",e&&0!==e.length?e.forEach(e=>{n.appendChild(function(e){const n=document.createElement("div");return n.className="item",n.dataset.barberiaId=e.id,n.innerHTML=`\n      <div class="badge-pill">${(e.nombre||"").charAt(0).toUpperCase()}</div>\n      <div style="flex:1">\n        <strong>${r(e.nombre)}</strong>\n        <div class="mini">${r(e.localidad||"")} — ${r((e.calle||"")+" "+(e.altura||""))}</div>\n      </div>\n      <div style="display:flex;gap:8px;align-items:center">\n        <a class="btn ghost" href="/booking?barberia=${encodeURIComponent(e.id)}">Ver y reservar</a>\n      </div>\n    `,n}(e))}):n.innerHTML='<div class="muted">No se encontraron barberías.</div>'}let a=null;function r(e){return e?String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}e.addEventListener("input",e=>{const r=e.target.value.trim();a&&clearTimeout(a),a=setTimeout(()=>{!function(e){const a=new FormData;a.append("q",e),fetch("/barberias/search",{method:"POST",body:a}).then(e=>e.json()).then(e=>{t(e.items||[])}).catch(()=>{n.innerHTML='<div class="muted">Error al buscar. Intentá de nuevo.</div>'})}(r)},300)})});